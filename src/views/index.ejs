<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GedotsHouse - Smart Home Premium</title>

    <link rel="canonical" href="https://gedotshouse.com/">
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" href="/css/store.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
</head>
<body>

<!-- NAVBAR -->
<nav class="epic-navbar" id="mainNav">
    <div class="nav-mega-container">

        <!-- Logo -->
        <a href="/" class="epic-logo">
            <div class="logo-symbol">
                <!-- HOME ICON -->
                <svg width="28" height="28" fill="white" viewBox="0 0 24 24">
                    <path d="M12 3l9 8h-3v10H6V11H3z"/>
                </svg>
            </div>
            <div class="logo-text">
                <h1>GedotsHouse</h1>
                <span class="logo-tagline">Premium Smart Home</span>
            </div>
        </a>

        <!-- Search -->
        <div class="epic-search">
            <div class="search-wrapper">
                <input 
                    type="search" 
                    class="search-input-epic" 
                    placeholder="Busca productos, marcas, categorías..."
                    aria-label="Buscar productos">

                <span class="search-icon-epic">
                    <!-- SEARCH ICON -->
                    <svg width="20" height="20" fill="#9CA3AF" viewBox="0 0 24 24">
                        <path d="M21 21l-4.35-4.35M11 19a8 8 0 1 1 0-16 8 8 0 0 1 0 16z"/>
                    </svg>
                </span>
            </div>
        </div>

        <!-- Actions -->
        <div class="nav-actions-epic">

            <!-- Wishlist -->
            <button class="nav-icon-btn" aria-label="Lista de deseos">
                <svg width="22" height="22" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M12 21s-6.716-4.534-9.192-9.192C-.62 6.15 2.387 2 6.808 2c2.208 0 4.208 1.208 5.192 3.09C13 3.208 15 2 17.192 2 21.613 2 24.62 6.15 21.192 11.808 18.716 16.466 12 21 12 21z"/>
                </svg>

                <% if (wishlistCount && wishlistCount > 0) { %>
                    <span class="nav-badge"><%= wishlistCount %></span>
                <% } %>
            </button>

            <!-- Cart -->
            <a href="/cart" class="nav-icon-btn" aria-label="Carrito de compras">
                <svg width="22" height="22" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M3 3h2l3.6 7.59-1.35 2.45A1 1 0 0 0 8 15h10v-2H8.42l.93-1.67h7.45c.38 0 .72-.21.89-.55L21 6H7.21L6.27 4H3zM7 18a2 2 0 1 1 0 4 2 2 0 0 1 0-4zm10 0a2 2 0 1 1 0 4 2 2 0 0 1 0-4z"/>
                </svg>

                <% if (cartCount && cartCount > 0) { %>
                    <span class="nav-badge"><%= cartCount %></span>
                <% } %>
            </a>

            <!-- Login / Cuenta / Admin -->
            <% if (user) { %>

                <!-- ADMIN -->
                <% if (user.role === "admin" || user.role === "super_admin") { %>
                    <a href="/admin/dashboard" class="btn-epic-primary">
                        <svg width="18" height="18" fill="white" viewBox="0 0 24 24">
                            <path d="M12 12a5 5 0 1 1 0-10 5 5 0 0 1 0 10zm-7 9a7 7 0 0 1 14 0v1H5v-1z"/>
                        </svg>
                        <span>Panel Admin</span>
                    </a>
                <% } %>

                <!-- MI CUENTA -->
                <a href="/account" class="btn-epic-primary">
                    <svg width="18" height="18" fill="white" viewBox="0 0 24 24">
                        <path d="M12 12a5 5 0 1 1 0-10 5 5 0 0 1 0 10zm-7 9a7 7 0 0 1 14 0v1H5v-1z"/>
                    </svg>
                    <span>Mi Cuenta</span>
                </a>

                <!-- LOGOUT -->
                <a href="/auth/logout" class="btn-epic-primary">
                    <svg width="18" height="18" fill="white" viewBox="0 0 24 24">
                        <path d="M16 13v-2H8V8l-5 4 5 4v-3zM20 3h-8v2h8v14h-8v2h8c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"/>
                    </svg>
                    <span>Cerrar Sesión</span>
                </a>

            <% } else { %>

                <!-- LOGIN -->
                <a href="/login" class="btn-epic-primary">
                    <svg width="18" height="18" fill="white" viewBox="0 0 24 24">
                        <path d="M10 17l5-5-5-5v3H3v4h7zM21 3H11v2h10v14H11v2h10c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"/>
                    </svg>
                    <span>Iniciar Sesión</span>
                </a>

            <% } %>

        </div>
    </div>
</nav>

<!-- HERO -->
<section class="epic-hero minimal-hero">
    <div class="hero-mesh-bg"></div>

    <div class="hero-content-grid">
        <div class="hero-text-section">
            <h1 class="hero-title">
                Smart Home Premium<br>
                <span class="gradient-text">Tecnología para tu Hogar</span>
            </h1>

            <p class="hero-subtitle">
                Automatización profesional, seguridad avanzada y experiencias inteligentes para tu casa.
            </p>

            <div class="hero-cta-group">
                <a href="#products" class="btn-hero-primary">Explorar Productos →</a>
                <a href="#categories" class="btn-hero-secondary">Categorías</a>
            </div>
        </div>

        <div class="hero-visual-section">
            <img src="https://cdn.pixabay.com/photo/2015/10/20/18/57/furniture-998265_1280.jpg" alt="Smart Home" style="width:100%;border-radius:20px;">
        </div>
    </div>
</section>

<!-- CATEGORIES -->
<!-- CATEGORIES HORIZONTAL -->
<section class="categories-horizontal" id="categories">

    <div class="section-header-epic">
        <h2 class="section-title-epic">Categorías</h2>
    </div>

    <div class="categories-scroll">
        <% categories.forEach(category => { %>

            <a href="/category/<%= category.id %>" class="category-chip">

                <div class="chip-icon">
                    <!-- Ícono dinámico (si lo tienes en DB) -->
                    <% if (category.icon) { %>
                        <span class="chip-icon-text"><%= category.icon %></span>
                    <% } else { %>
                        <!-- Default icon (SVG) -->
                        <svg width="26" height="26" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M21 16V8l-9-5-9 5v8l9 5 9-5zM12 4.3L18.5 8 12 11.7 5.5 8 12 4.3z"/>
                        </svg>
                    <% } %>
                </div>

                <div class="chip-info">
                    <h3><%= category.name %></h3>
                    <span><%= category.product_count %> productos</span>
                </div>

            </a>

        <% }) %>
    </div>

</section>

<!-- PRODUCTS -->
<section class="products-epic" id="products">

    <div class="products-header">
        <h2 class="section-title-epic">Productos</h2>
    </div>

    <div class="products-grid-epic">

        <% if (products.length === 0) { %>
            <p>No hay productos disponibles.</p>
        <% } %>

        <% products.forEach(product => { %>
        <article class="product-card-epic">

            <div class="product-image-container">

                <% if (product.image_url) { %>
                    <img src="<%= product.image_url %>" class="product-image-epic" loading="lazy">
                <% } else { %>
                    <div class="product-image-epic placeholder-img">
                        <!-- CUBE ICON -->
                        <svg width="48" height="48" fill="#9CA3AF" viewBox="0 0 24 24">
                            <path d="M21 16V8l-9-5-9 5v8l9 5 9-5zM12 4.3L18.5 8 12 11.7 5.5 8 12 4.3z"/>
                        </svg>
                    </div>
                <% } %>

                <% if (product.stock_quantity <= 0) { %>
                    <div class="soldout-badge">AGOTADO</div>
                <% } %>

            </div>

            <div class="product-info-epic">
                <span class="product-category-tag">
                    <%= product.category_name || "Smart Home" %>
                </span>

                <h3 class="product-name-epic"><%= product.name %></h3>

                <p class="product-description-epic">
                    <%= product.short_description || "" %>
                </p>

                <div class="product-footer-epic">

                    <div class="price-section-epic">
                        <span class="price-current-epic">$<%= product.price %></span>
                    </div>

                    <% if (product.stock_quantity > 0) { %>

                    <button class="btn-add-to-cart-epic"
                        onclick="addToCart('<%= product.id %>')">
                        <svg width="20" height="20" fill="white" viewBox="0 0 24 24">
                            <path d="M3 3h2l3.6 7.59-1.35 2.45A1 1 0 0 0 8 15h10v-2H8.42l.93-1.67h7.45c.38 0 .72-.21.89-.55L21 6H7.21L6.27 4H3zM7 18a2 2 0 1 1 0 4 2 2 0 0 1 0-4zm10 0a2 2 0 1 1 0 4 2 2 0 0 1 0-4z"/>
                        </svg>
                        Agregar
                    </button>

                    <% } else { %>

                    <button class="btn-add-to-cart-epic btn-disabled" disabled>
                        <svg width="20" height="20" fill="white" viewBox="0 0 24 24">
                            <path d="M18 6L6 18M6 6l12 12" stroke-width="2" stroke="white" fill="none"/>
                        </svg>
                        Sin stock
                    </button>

                    <% } %>

                </div>
            </div>

        </article>
        <% }) %>

    </div>
</section>

<!-- FOOTER -->
<footer class="epic-footer">
    <p>&copy; 2025 GedotsHouse. Todos los derechos reservados.</p>
</footer>

<script>
async function addToCart(productId) {
    await fetch("/cart/add", {
        method: "POST",
        headers: {"Content-Type":"application/json"},
        body: JSON.stringify({ productId, quantity: 1 })
    });
    location.reload();
}
</script>

</body>
</html>